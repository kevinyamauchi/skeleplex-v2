
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../branches/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>angles - Skeleplex</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#skeleplex.measurements.angles" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Skeleplex" class="md-header__button md-logo" aria-label="Skeleplex" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skeleplex
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              angles
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Skeleplex" class="md-nav__button md-logo" aria-label="Skeleplex" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Skeleplex
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    skeleplex
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    skeleplex
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../app/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    app
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    app
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _app
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _constants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_curate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _curate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_viewer_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _viewer_controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../app/cellier/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    cellier
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_8" id="__nav_2_1_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    cellier
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/cellier/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../app/qt/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    qt
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_10" id="__nav_2_1_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    qt
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/app_controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    app_controls
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/auxiliary_views/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    auxiliary_views
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/flat_group_box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    flat_group_box
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/main_viewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    main_viewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/styles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    styles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/window/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    window
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    data
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    data
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/bifurcating_tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bifurcating_tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fractal_trees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fractal_trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/skeleton_image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeleton_image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/skeletons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeletons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tubes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tubes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/y_junctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    y_junctions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../graph/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    graph
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    graph
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/break_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    break_detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    constants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/image_to_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    image_to_graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/image_to_graph_lazy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    image_to_graph_lazy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/modify_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    modify_graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/sample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sample
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/skeleton_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeleton_graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/spline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    measurements
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    measurements
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    angles
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    angles
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.angle_metric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;angle_metric
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_branch_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_midline_branch_angle_branch_nodes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_midline_branch_angle_spline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_midline_branch_angle_spline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(sample_positions)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;sample_positions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(approx)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;approx
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_rotation_angle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_rotation_angle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_rotation_angle_parent_vector_daughter_plane
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_rotation_angle_parent_vector_daughter_plane">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_sibling_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_sibling_angle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_sibling_angle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_sibling_angle(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_surface_normals_and_angles
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_surface_normals_and_angles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(skeletons)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeletons
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(stage_list)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stage_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(lobes)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;lobes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(smooth)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;smooth
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.run_all_angle_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_all_angle_metrics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../branches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    branches
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fit_surface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fit_surface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph_properties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    graph_properties
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lumen_classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    lumen_classifier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../skeleton/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    skeleton
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_5" id="__nav_2_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    skeleton
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_chunked_label/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _chunked_label
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_chunked_upscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _chunked_upscale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_segment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _segment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_skeletonize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _skeletonize
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_upscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _upscale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/distance_field/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    distance_field
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/_chunked/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _chunked
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/_geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _geometry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../visualize/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    visualize
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    visualize
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualize/_color/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _color
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualize/spline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.angle_metric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;angle_metric
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_branch_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_midline_branch_angle_branch_nodes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_midline_branch_angle_spline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_midline_branch_angle_spline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(sample_positions)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;sample_positions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(approx)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;approx
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_rotation_angle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_rotation_angle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_rotation_angle_parent_vector_daughter_plane
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_rotation_angle_parent_vector_daughter_plane">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_sibling_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_sibling_angle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_sibling_angle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_sibling_angle(graph)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;graph
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_surface_normals_and_angles
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_surface_normals_and_angles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(skeletons)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeletons
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(stage_list)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stage_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(lobes)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;lobes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(smooth)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;smooth
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.measurements.angles.run_all_angle_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_all_angle_metrics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<div class="doc doc-object doc-module">



<h1 id="skeleplex.measurements.angles" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">skeleplex.measurements.angles</span>


</h1>

    <div class="doc doc-contents first">












<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            angle_metric (skeleplex.measurements.angles.angle_metric)" href="#skeleplex.measurements.angles.angle_metric">angle_metric</a></code></b>
            –
            <div class="doc-md-description">
              <p>Decorator to register a function as an angle metric.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_midline_branch_angle_branch_nodes (skeleplex.measurements.angles.compute_midline_branch_angle_branch_nodes)" href="#skeleplex.measurements.angles.compute_midline_branch_angle_branch_nodes">compute_midline_branch_angle_branch_nodes</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculates the midline branch angle for each branch in the graph.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_midline_branch_angle_spline (skeleplex.measurements.angles.compute_midline_branch_angle_spline)" href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline">compute_midline_branch_angle_spline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculates the midline branch angle for each branch in the graph.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_rotation_angle (skeleplex.measurements.angles.compute_rotation_angle)" href="#skeleplex.measurements.angles.compute_rotation_angle">compute_rotation_angle</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculates the rotation angle for each edge in the graph.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_rotation_angle_parent_vector_daughter_plane (skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane)" href="#skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane">compute_rotation_angle_parent_vector_daughter_plane</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculates the rotation angle between the parent vector and the daughter plane.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_sibling_angle (skeleplex.measurements.angles.compute_sibling_angle)" href="#skeleplex.measurements.angles.compute_sibling_angle">compute_sibling_angle</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculates the sibling angle for each edge in the graph.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            compute_surface_normals_and_angles (skeleplex.measurements.angles.compute_surface_normals_and_angles)" href="#skeleplex.measurements.angles.compute_surface_normals_and_angles">compute_surface_normals_and_angles</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes surface normals and angles between surface normals and branch vectors.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            run_all_angle_metrics (skeleplex.measurements.angles.run_all_angle_metrics)" href="#skeleplex.measurements.angles.run_all_angle_metrics">run_all_angle_metrics</a></code></b>
            –
            <div class="doc-md-description">
              <p>Runs all registered angle metrics in order.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.angle_metric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">angle_metric</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">angle_metric</span><span class="p">(</span><span class="n"><span title="skeleplex.measurements.angles.angle_metric(func)">func</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Decorator to register a function as an angle metric.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">angle_metric</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to register a function as an angle metric.&quot;&quot;&quot;</span>
    <span class="n">_ANGLE_FUNCTIONS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.compute_midline_branch_angle_branch_nodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_midline_branch_angle_branch_nodes</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_midline_branch_angle_branch_nodes</span><span class="p">(</span><span class="n"><span title="skeleplex.measurements.angles.compute_midline_branch_angle_branch_nodes(graph)">graph</span></span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the midline branch angle for each branch in the graph.</p>
<p>Computes the midline anlges for each branch in the graph and returns
the midline branch angle as an edge attribute.</p>
<p>To compute the vectors, only the branch nodes are taken in consideration.
Branches are simplified to a straight line between branch nodes.</p>
<p>Graph requirements:
- The graph must be directed
- The graph must be ordered with the desired hierarchy
- The graph must have a 'node_coordinate' attribute for each node</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>graph</code></b> (              <code><span title="networkx.DiGraph">DiGraph</span></code>
)          –
          <div class="doc-md-description">
            <p>The input graph with the angles added as edge attributes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>midline_vector</code></b> (              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
)          –
          <div class="doc-md-description">
            <p>Array of shape (n_edges, 2, 3) containing the start and end points
of the midline vectors for visualization.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>Raises and error if the end point of the parent branch and the
start point of the daughter branch are not the same</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>Raises and error if the length of the midline vector is != 1</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>Raises and error if the length of the branch vector is != 1</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@angle_metric</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_midline_branch_angle_branch_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the midline branch angle for each branch in the graph.</span>

<span class="sd">    Computes the midline anlges for each branch in the graph and returns</span>
<span class="sd">    the midline branch angle as an edge attribute.</span>

<span class="sd">    To compute the vectors, only the branch nodes are taken in consideration.</span>
<span class="sd">    Branches are simplified to a straight line between branch nodes.</span>

<span class="sd">    Graph requirements:</span>
<span class="sd">    - The graph must be directed</span>
<span class="sd">    - The graph must be ordered with the desired hierarchy</span>
<span class="sd">    - The graph must have a &#39;node_coordinate&#39; attribute for each node</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph with the angles added as edge attributes</span>

<span class="sd">    midline_vector : np.ndarray</span>
<span class="sd">        Array of shape (n_edges, 2, 3) containing the start and end points</span>
<span class="sd">        of the midline vectors for visualization.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises and error if the end point of the parent branch and the</span>
<span class="sd">        start point of the daughter branch are not the same</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises and error if the length of the midline vector is != 1</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises and error if the length of the branch vector is != 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">angle_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">center_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">midline_points</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">node_coordinates</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">NODE_COORDINATE_KEY</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
            <span class="k">continue</span>
        <span class="n">parent_edge</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>

        <span class="n">parent_start_node_coordinates</span> <span class="o">=</span> <span class="n">node_coordinates</span><span class="p">[</span><span class="n">parent_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">parent_end_node_coordinates</span> <span class="o">=</span> <span class="n">node_coordinates</span><span class="p">[</span><span class="n">parent_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">parent_vector</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span>
            <span class="n">parent_start_node_coordinates</span> <span class="o">-</span> <span class="n">parent_end_node_coordinates</span>
        <span class="p">)</span>
        <span class="n">midline_vector</span> <span class="o">=</span> <span class="o">-</span><span class="n">parent_vector</span>

        <span class="n">start_node_coordinates</span> <span class="o">=</span> <span class="n">node_coordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">parent_end_node_coordinates</span> <span class="o">!=</span> <span class="n">start_node_coordinates</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Branch point ill defined.&quot;</span><span class="p">)</span>

        <span class="n">end_node_coordinates</span> <span class="o">=</span> <span class="n">node_coordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">branch_vector</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">end_node_coordinates</span> <span class="o">-</span> <span class="n">start_node_coordinates</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">midline_vector</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;Midline vector is not normalized.</span>
<span class="s2">                             Its length is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">midline_vector</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">branch_vector</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;Branch vector is not normalized.</span>
<span class="s2">                             Its length is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">branch_vector</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">dot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">midline_vector</span><span class="p">,</span> <span class="n">branch_vector</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">dot</span><span class="p">))</span>
        <span class="n">angle_dict</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>

        <span class="c1"># store for visualization</span>
        <span class="n">center_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_end_node_coordinates</span><span class="p">)</span>
        <span class="n">midline_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_end_node_coordinates</span> <span class="o">+</span> <span class="p">(</span><span class="mi">50</span> <span class="o">*</span> <span class="n">midline_vector</span><span class="p">))</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">angle_dict</span><span class="p">,</span> <span class="n">BRANCH_ANGLE_EDGE_KEY</span><span class="p">)</span>
    <span class="n">midline_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center_points</span><span class="p">,</span> <span class="n">midline_points</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="n">midline_vector</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.compute_midline_branch_angle_spline" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_midline_branch_angle_spline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_midline_branch_angle_spline</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="graph (skeleplex.measurements.angles.compute_midline_branch_angle_spline(graph))" href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(graph)">graph</a></span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sample_positions (skeleplex.measurements.angles.compute_midline_branch_angle_spline(sample_positions))" href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(sample_positions)">sample_positions</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="approx (skeleplex.measurements.angles.compute_midline_branch_angle_spline(approx))" href="#skeleplex.measurements.angles.compute_midline_branch_angle_spline(approx)">approx</a></span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the midline branch angle for each branch in the graph.</p>
<p>Computes the midline angles for each branch in the graph and returns
the midline branch angle as an edge attribute.</p>
<p>To compute the vectors, the spline is used to sample points along the
branch. Angles are computed between the tangent of the spline of the branch
and the tangent of the spline of the parent branch. Sampling distance starts
at the common node and moves towards the end of both branches.</p>
<p>Graph requirements:
- The graph must be directed
- The graph must be ordered with the desired hierarchy
- The graph must have a 'node_coordinate' attribute for each node</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_midline_branch_angle_spline(graph)" class="doc doc-heading doc-heading-parameter">              <b><code>graph</code></b>
</h3>              (<code><span title="networkx.DiGraph">DiGraph</span></code>)
          –
          <div class="doc-md-description">
            <p>The input graph</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_midline_branch_angle_spline(sample_positions)" class="doc doc-heading doc-heading-parameter">              <b><code>sample_positions</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.array" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array">array</a></code>)
          –
          <div class="doc-md-description">
            <p>List of positions along the spline to sample the tangents</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_midline_branch_angle_spline(approx)" class="doc doc-heading doc-heading-parameter">              <b><code>approx</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, evaluate the spline using an approximation</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>graph</code></b> (              <code><span title="networkx.DiGraph">DiGraph</span></code>
)          –
          <div class="doc-md-description">
            <p>The input graph with the angles added as edge attributes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>sample_position_list</code></b> (              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
)          –
          <div class="doc-md-description">
            <p>Returns the position on which the tangents of the spline were taken.
For debugging purposes.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>Raises and error if the end point of the parent branch and the
start point of the daughter branch are not the same</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>Raises and error if the length of the midline vector is != 1</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>Raises and error if the length of the branch vector is != 1</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@angle_metric</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_midline_branch_angle_spline</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">sample_positions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">approx</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the midline branch angle for each branch in the graph.</span>

<span class="sd">    Computes the midline angles for each branch in the graph and returns</span>
<span class="sd">    the midline branch angle as an edge attribute.</span>

<span class="sd">    To compute the vectors, the spline is used to sample points along the</span>
<span class="sd">    branch. Angles are computed between the tangent of the spline of the branch</span>
<span class="sd">    and the tangent of the spline of the parent branch. Sampling distance starts</span>
<span class="sd">    at the common node and moves towards the end of both branches.</span>

<span class="sd">    Graph requirements:</span>
<span class="sd">    - The graph must be directed</span>
<span class="sd">    - The graph must be ordered with the desired hierarchy</span>
<span class="sd">    - The graph must have a &#39;node_coordinate&#39; attribute for each node</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph</span>
<span class="sd">    sample_positions : np.array</span>
<span class="sd">        List of positions along the spline to sample the tangents</span>
<span class="sd">    approx : bool</span>
<span class="sd">        If True, evaluate the spline using an approximation</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph with the angles added as edge attributes</span>
<span class="sd">    sample_position_list: list</span>
<span class="sd">        Returns the position on which the tangents of the spline were taken.</span>
<span class="sd">        For debugging purposes.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises and error if the end point of the parent branch and the</span>
<span class="sd">        start point of the daughter branch are not the same</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises and error if the length of the midline vector is != 1</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises and error if the length of the branch vector is != 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">angle_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">sample_positions_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># loop over each edge</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">parent_edge</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent_edge</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">parent_edge</span> <span class="o">=</span> <span class="n">parent_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">parent_spline</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">parent_edge</span><span class="p">][</span><span class="n">EDGE_SPLINE_KEY</span><span class="p">]</span>
        <span class="n">spline</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">EDGE_SPLINE_KEY</span><span class="p">]</span>
        <span class="c1"># sample_positions = np.linspace(0, 1, n_samples)</span>
        <span class="n">parent_tangents</span> <span class="o">=</span> <span class="n">parent_spline</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
            <span class="mi">1</span> <span class="o">-</span> <span class="n">sample_positions</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">approx</span><span class="o">=</span><span class="n">approx</span>
        <span class="p">)</span>
        <span class="n">sample_positions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">parent_spline</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sample_positions</span><span class="p">,</span> <span class="n">approx</span><span class="o">=</span><span class="n">approx</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">tangents</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">sample_positions</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">approx</span><span class="o">=</span><span class="n">approx</span><span class="p">)</span>
        <span class="n">sample_positions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">sample_positions</span><span class="p">,</span> <span class="n">approx</span><span class="o">=</span><span class="n">approx</span><span class="p">))</span>
        <span class="c1"># normalize the tangents</span>
        <span class="n">tangents</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_vector</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tangents</span><span class="p">]</span>
        <span class="n">parent_tangents</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_vector</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">parent_tangents</span><span class="p">]</span>

        <span class="n">angle_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tangents</span><span class="p">)):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">tangents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent_tangents</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">pt</span> <span class="o">=</span> <span class="n">parent_tangents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">dot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">dot</span><span class="p">))</span>

            <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="c1"># angle_std = np.std(angle_list)</span>
        <span class="n">mean_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">angle_list</span><span class="p">)</span>
        <span class="n">angle_dict</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_angle</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">angle_dict</span><span class="p">,</span> <span class="n">BRANCH_ANGLE_JUNCTION_EDGE_KEY</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="n">sample_positions_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.compute_rotation_angle" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_rotation_angle</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_rotation_angle</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="graph (skeleplex.measurements.angles.compute_rotation_angle(graph))" href="#skeleplex.measurements.angles.compute_rotation_angle(graph)">graph</a></span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the rotation angle for each edge in the graph.</p>
<p>Compute the rotation angle between the plane defined by the parent node
and the plane defined by the edge and its sister.</p>
<p>The edge attribute is defined in the
ROTATION_ANGLE_EDGE_KEY constant.</p>
<p>The input graph should have the following attributes:</p>
<ul>
<li>NODE_COORDINATE_KEY: The node coordinates</li>
<li>SISTER_EDGE_KEY: The sister edge</li>
<li>Directed graph with the correct orientation</li>
<li>Strictly dichotomous tree</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_rotation_angle(graph)" class="doc doc-heading doc-heading-parameter">              <b><code>graph</code></b>
</h3>              (<code><span title="networkx.DiGraph">DiGraph</span></code>)
          –
          <div class="doc-md-description">
            <p>The input graph</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@angle_metric</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_rotation_angle</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the rotation angle for each edge in the graph.</span>

<span class="sd">    Compute the rotation angle between the plane defined by the parent node</span>
<span class="sd">    and the plane defined by the edge and its sister.</span>

<span class="sd">    The edge attribute is defined in the</span>
<span class="sd">    ROTATION_ANGLE_EDGE_KEY constant.</span>

<span class="sd">    The input graph should have the following attributes:</span>

<span class="sd">    - NODE_COORDINATE_KEY: The node coordinates</span>
<span class="sd">    - SISTER_EDGE_KEY: The sister edge</span>
<span class="sd">    - Directed graph with the correct orientation</span>
<span class="sd">    - Strictly dichotomous tree</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rotation_angle_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">node_coord</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">NODE_COORDINATE_KEY</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">sister</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">SISTER_EDGE_KEY</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]:</span>
            <span class="n">sister</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">SISTER_EDGE_KEY</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">sister</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">parent_sister</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">SISTER_EDGE_KEY</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">parent</span><span class="p">]:</span>
            <span class="n">parent_sister</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">parent</span><span class="p">][</span><span class="n">SISTER_EDGE_KEY</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent_sister</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent_sister</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">parent_sister</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">parent_sister</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sister</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">sister</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sister</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">parent_plane</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">node_coord</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">node_coord</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">node_coord</span><span class="p">[</span><span class="n">parent_sister</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">]</span>

        <span class="n">edge_plane</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_coord</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">node_coord</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">node_coord</span><span class="p">[</span><span class="n">sister</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="k">if</span> <span class="n">parent_plane</span> <span class="ow">and</span> <span class="n">edge_plane</span><span class="p">:</span>
            <span class="n">normal_parent</span> <span class="o">=</span> <span class="n">get_normal_of_plane</span><span class="p">(</span>
                <span class="n">parent_plane</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">parent_plane</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">parent_plane</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">normal_edge</span> <span class="o">=</span> <span class="n">get_normal_of_plane</span><span class="p">(</span>
                <span class="n">edge_plane</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_plane</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">edge_plane</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">normal_parent_unit</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">normal_parent</span><span class="p">)</span>
            <span class="n">normal_edge_unit</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">normal_edge</span><span class="p">)</span>
            <span class="n">rotation_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">normal_parent_unit</span><span class="p">,</span> <span class="n">normal_edge_unit</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">rotation_angle</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">rotation_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">rotation_angle</span>
            <span class="n">rotation_angle_dict</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">rad2deg</span><span class="p">(</span><span class="n">rotation_angle</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">rotation_angle_dict</span><span class="p">,</span> <span class="n">ROTATION_ANGLE_EDGE_KEY</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">graph</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_rotation_angle_parent_vector_daughter_plane</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_rotation_angle_parent_vector_daughter_plane</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="graph (skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane(graph))" href="#skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane(graph)">graph</a></span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the rotation angle between the parent vector and the daughter plane.</p>
<p>Compute the rotation angle between the parent vector
and the plane defined by the edge and its sister.
The edge attribute is defined in the
ROTATION_ANGLE_EDGE_KEY constant.
The input graph should have the following attributes:
- NODE_COORDINATE_KEY: The node coordinates
- SISTER_EDGE_KEY: The sister edge
- Directed graph with the correct orientation
- Strictly dichotomous tree</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_rotation_angle_parent_vector_daughter_plane(graph)" class="doc doc-heading doc-heading-parameter">              <b><code>graph</code></b>
</h3>              (<code><span title="networkx.DiGraph">DiGraph</span></code>)
          –
          <div class="doc-md-description">
            <p>The input graph</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@angle_metric</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_rotation_angle_parent_vector_daughter_plane</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the rotation angle between the parent vector and the daughter plane.</span>

<span class="sd">    Compute the rotation angle between the parent vector</span>
<span class="sd">    and the plane defined by the edge and its sister.</span>
<span class="sd">    The edge attribute is defined in the</span>
<span class="sd">    ROTATION_ANGLE_EDGE_KEY constant.</span>
<span class="sd">    The input graph should have the following attributes:</span>
<span class="sd">    - NODE_COORDINATE_KEY: The node coordinates</span>
<span class="sd">    - SISTER_EDGE_KEY: The sister edge</span>
<span class="sd">    - Directed graph with the correct orientation</span>
<span class="sd">    - Strictly dichotomous tree</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rotation_angle_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">node_coord</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">NODE_COORDINATE_KEY</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">sister</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">SISTER_EDGE_KEY</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]:</span>
            <span class="n">sister</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">SISTER_EDGE_KEY</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">sister</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>



        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sister</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">sister</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sister</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">parent_vector</span> <span class="o">=</span> <span class="n">node_coord</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">node_coord</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">parent_vector_unit</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">parent_vector</span><span class="p">)</span>

        <span class="n">edge_plane</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_coord</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">node_coord</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">node_coord</span><span class="p">[</span><span class="n">sister</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="k">if</span>  <span class="n">edge_plane</span><span class="p">:</span>

            <span class="n">normal_edge</span> <span class="o">=</span> <span class="n">get_normal_of_plane</span><span class="p">(</span>
                <span class="n">edge_plane</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_plane</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">edge_plane</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">rotation_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">parent_vector_unit</span><span class="p">,</span>
                                              <span class="n">unit_vector</span><span class="p">(</span><span class="n">normal_edge</span><span class="p">)))</span>
            <span class="c1"># if rotation_angle &gt; np.pi / 2:</span>
            <span class="c1">#     rotation_angle = np.pi - rotation_angle</span>
            <span class="n">rotation_angle_dict</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">rad2deg</span><span class="p">(</span><span class="n">rotation_angle</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">rotation_angle_dict</span><span class="p">,</span> <span class="n">ROTATION_ANGLE_VECTOR_EDGE_KEY</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">graph</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.compute_sibling_angle" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_sibling_angle</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_sibling_angle</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="graph (skeleplex.measurements.angles.compute_sibling_angle(graph))" href="#skeleplex.measurements.angles.compute_sibling_angle(graph)">graph</a></span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the sibling angle for each edge in the graph.</p>
<p>Computes the sibling angles for each edge in the graph
and returns the sibling angle as an edge attribute.</p>
<p>The sibling angle is the angle between the edge and its sister edge.</p>
<p>Graph requirements:
- The graph must be directed
- The graph must be ordered with the desired hierarchy
- The graph must have a 'node_coordinate' attribute for each node</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_sibling_angle(graph)" class="doc doc-heading doc-heading-parameter">              <b><code>graph</code></b>
</h3>              (<code><span title="networkx.DiGraph">DiGraph</span></code>)
          –
          <div class="doc-md-description">
            <p>The input graph</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>graph</code></b> (              <code><span title="networkx.DiGraph">DiGraph</span></code>
)          –
          <div class="doc-md-description">
            <p>The input graph with the sibling angle added as edge attributes</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@angle_metric</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_sibling_angle</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the sibling angle for each edge in the graph.</span>

<span class="sd">    Computes the sibling angles for each edge in the graph</span>
<span class="sd">    and returns the sibling angle as an edge attribute.</span>

<span class="sd">    The sibling angle is the angle between the edge and its sister edge.</span>

<span class="sd">    Graph requirements:</span>
<span class="sd">    - The graph must be directed</span>
<span class="sd">    - The graph must be ordered with the desired hierarchy</span>
<span class="sd">    - The graph must have a &#39;node_coordinate&#39; attribute for each node</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph : nx.DiGraph</span>
<span class="sd">        The input graph with the sibling angle added as edge attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">angle_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">sister_pairs</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">SISTER_EDGE_KEY</span><span class="p">)</span>
    <span class="n">sister_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">edge</span><span class="p">,</span> <span class="n">sister_pairs</span><span class="p">[</span><span class="n">edge</span><span class="p">])</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">sister_pairs</span><span class="p">]</span>
    <span class="c1"># keep only one sister pair as they both have the same angle</span>
    <span class="n">unique_pairs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">sister_pairs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">pair</span><span class="p">))</span>
        <span class="n">unique_pairs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
    <span class="n">unique_pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_pairs</span><span class="p">)</span>

    <span class="n">node_coordinates</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">NODE_COORDINATE_KEY</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sister_pair</span> <span class="ow">in</span> <span class="n">unique_pairs</span><span class="p">:</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">sister_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sister</span> <span class="o">=</span> <span class="n">sister_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">shared_node_coord</span> <span class="o">=</span> <span class="n">node_coordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">edge_vector</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">node_coordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">shared_node_coord</span><span class="p">)</span>
        <span class="n">sister_vector</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">node_coordinates</span><span class="p">[</span><span class="n">sister</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">shared_node_coord</span><span class="p">)</span>

        <span class="n">dot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">edge_vector</span><span class="p">,</span> <span class="n">sister_vector</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">dot</span><span class="p">))</span>
        <span class="n">angle_dict</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="n">angle_dict</span><span class="p">[</span><span class="n">sister</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">angle_dict</span><span class="p">,</span> <span class="n">SIBLING_ANGLE_EDGE_KEY</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">graph</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.compute_surface_normals_and_angles" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_surface_normals_and_angles</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_surface_normals_and_angles</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="skeletons (skeleplex.measurements.angles.compute_surface_normals_and_angles(skeletons))" href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(skeletons)">skeletons</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="stage_list (skeleplex.measurements.angles.compute_surface_normals_and_angles(stage_list))" href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(stage_list)">stage_list</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="lobes (skeleplex.measurements.angles.compute_surface_normals_and_angles(lobes))" href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(lobes)">lobes</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;LeftLobe&#39;</span><span class="p">,</span> <span class="s1">&#39;InferiorLobe&#39;</span><span class="p">,</span> <span class="s1">&#39;MiddleLobe&#39;</span><span class="p">,</span> <span class="s1">&#39;SuperiorLobe&#39;</span><span class="p">,</span> <span class="s1">&#39;PostCavalLobe&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="smooth (skeleplex.measurements.angles.compute_surface_normals_and_angles(smooth))" href="#skeleplex.measurements.angles.compute_surface_normals_and_angles(smooth)">smooth</a></span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Computes surface normals and angles between surface normals and branch vectors.</p>
<p>Fits surfaces, computes surface normals, and calculates the angle between
surface normals and branch vectors for a list of skeletons.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_surface_normals_and_angles(skeletons)" class="doc doc-heading doc-heading-parameter">              <b><code>skeletons</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>)
          –
          <div class="doc-md-description">
            <p>List of SkeletonGraph objects</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_surface_normals_and_angles(stage_list)" class="doc doc-heading doc-heading-parameter">              <b><code>stage_list</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>)
          –
          <div class="doc-md-description">
            <p>List of stage names</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_surface_normals_and_angles(lobes)" class="doc doc-heading doc-heading-parameter">              <b><code>lobes</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></code>, default:
                  <code>(&#39;LeftLobe&#39;, &#39;InferiorLobe&#39;, &#39;MiddleLobe&#39;, &#39;SuperiorLobe&#39;, &#39;PostCavalLobe&#39;)</code>
)
          –
          <div class="doc-md-description">
            <p>Tuple of lobe names</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.measurements.angles.compute_surface_normals_and_angles(smooth)" class="doc doc-heading doc-heading-parameter">              <b><code>smooth</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1000</code>
)
          –
          <div class="doc-md-description">
            <p>Smoothing parameter for the surface fitting</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>- list_dict_normal_dicts: List of dictionaries</code>
          –
          <div class="doc-md-description">
            <p>containing normal vectors for each lobe</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_surface_normals_and_angles</span><span class="p">(</span>
    <span class="n">skeletons</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">stage_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">lobes</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;LeftLobe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;InferiorLobe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MiddleLobe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SuperiorLobe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PostCavalLobe&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">smooth</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes surface normals and angles between surface normals and branch vectors.</span>

<span class="sd">    Fits surfaces, computes surface normals, and calculates the angle between</span>
<span class="sd">    surface normals and branch vectors for a list of skeletons.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    skeletons : list</span>
<span class="sd">        List of SkeletonGraph objects</span>
<span class="sd">    stage_list : list</span>
<span class="sd">        List of stage names</span>
<span class="sd">    lobes : tuple</span>
<span class="sd">        Tuple of lobe names</span>
<span class="sd">    smooth : int</span>
<span class="sd">        Smoothing parameter for the surface fitting</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - list_dict_normal_dicts: List of dictionaries</span>
<span class="sd">        containing normal vectors for each lobe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">list_dict_normal_dicts</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">surface_stage_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">skeleton</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skeletons</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing stage </span><span class="si">{</span><span class="n">stage_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dict_normal_dicts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">skeleton</span><span class="o">.</span><span class="n">graph</span>

        <span class="c1"># Fit surface and get normals</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Fitting surfaces and getting normals...&quot;</span><span class="p">)</span>
        <span class="n">surface_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">lobe</span> <span class="ow">in</span> <span class="n">lobes</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing lobe </span><span class="si">{</span><span class="n">lobe</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">normal_dict</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">surface</span> <span class="o">=</span> <span class="n">fit_surface_and_get_surface_normal_of_branches</span><span class="p">(</span>
                <span class="n">graph</span><span class="p">,</span> <span class="n">lobe</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span>
            <span class="p">)</span>
            <span class="n">dict_normal_dicts</span><span class="p">[</span><span class="n">lobe</span><span class="p">]</span> <span class="o">=</span> <span class="n">normal_dict</span>
            <span class="n">surface_dict</span><span class="p">[</span><span class="n">lobe</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface</span>

        <span class="n">surface_stage_dict</span><span class="p">[</span><span class="n">stage_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">surface_dict</span>

        <span class="n">list_dict_normal_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_normal_dicts</span><span class="p">)</span>

        <span class="c1"># Compute angle between surface normal and branch</span>
        <span class="n">lobe_edge_dict</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">LOBE_NAME_KEY</span><span class="p">)</span>
        <span class="n">splines</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">EDGE_SPLINE_KEY</span><span class="p">)</span>
        <span class="n">node_coords</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">NODE_COORDINATE_KEY</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing angles...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="n">spline</span> <span class="o">=</span> <span class="n">splines</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span>
            <span class="n">lobe_of_edge</span> <span class="o">=</span> <span class="n">lobe_edge_dict</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">lobe_of_edge</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&lt;class &#39;str&#39;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="n">u_coord</span> <span class="o">=</span> <span class="n">node_coords</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
            <span class="n">v_coord</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">approx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">edge_vector</span> <span class="o">=</span> <span class="n">unit_vector</span><span class="p">(</span><span class="n">v_coord</span> <span class="o">-</span> <span class="n">u_coord</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">surface_vector</span> <span class="o">=</span> <span class="n">dict_normal_dicts</span><span class="p">[</span><span class="n">lobe_of_edge</span><span class="p">][</span><span class="n">edge</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">edge_vector</span><span class="p">,</span> <span class="n">surface_vector</span><span class="p">))</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">rad2deg</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="mi">90</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">SURFACE_ANGLE_EDGE_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>

        <span class="n">skeleton</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span>

    <span class="k">return</span> <span class="n">list_dict_normal_dicts</span><span class="p">,</span> <span class="n">surface_stage_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.measurements.angles.run_all_angle_metrics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_all_angle_metrics</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_all_angle_metrics</span><span class="p">(</span><span class="n"><span title="skeleplex.measurements.angles.run_all_angle_metrics(graph)">graph</span></span><span class="p">,</span> <span class="o">**</span><span class="n"><span title="skeleplex.measurements.angles.run_all_angle_metrics(**kwargs)">kwargs</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Runs all registered angle metrics in order.</p>
<p>Each metric must accept a graph, and may accept additional keyword arguments.
Returns a list of (name, graph_out, extra_return_values).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/measurements/angles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_all_angle_metrics</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs all registered angle metrics in order.</span>

<span class="sd">    Each metric must accept a graph, and may accept additional keyword arguments.</span>
<span class="sd">    Returns a list of (name, graph_out, extra_return_values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">graph</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">_ANGLE_FUNCTIONS</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running angle metric: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">func</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_varnames</span><span class="p">})</span>
        <span class="c1"># out can be (graph) or (graph, extra)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">out</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">extra</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">g</span><span class="p">,</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["search.highlight", "search.suggest", "content.code.copy", "content.code.annotate", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>