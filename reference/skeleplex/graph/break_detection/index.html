
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../constants/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>break_detection - Skeleplex</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#skeleplex.graph.break_detection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Skeleplex" class="md-header__button md-logo" aria-label="Skeleplex" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skeleplex
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              break_detection
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Skeleplex" class="md-nav__button md-logo" aria-label="Skeleplex" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Skeleplex
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    skeleplex
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    skeleplex
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../app/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    app
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    app
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _app
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _constants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_curate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _curate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/_viewer_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _viewer_controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../app/cellier/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    cellier
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_8" id="__nav_2_1_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    cellier
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/cellier/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../app/qt/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    qt
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1_10" id="__nav_2_1_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    qt
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/app_controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    app_controls
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/auxiliary_views/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    auxiliary_views
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/flat_group_box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    flat_group_box
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/main_viewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    main_viewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/styles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    styles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../app/qt/window/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    window
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    data
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    data
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/bifurcating_tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bifurcating_tree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fractal_trees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fractal_trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/skeleton_image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeleton_image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/skeletons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeletons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tubes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tubes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/y_junctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    y_junctions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    graph
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    graph
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    break_detection
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    break_detection
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;check_background_intersection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" check_background_intersection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(end_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;end_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(step_size)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;step_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;filter_points_from_same_branch
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" filter_points_from_same_branch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch(query_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;query_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_breaks_in_skeleton
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_breaks_in_skeleton">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_obj)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_obj
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(end_point_radius)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;end_point_radius
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(segmentation_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;segmentation_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(n_workers)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;n_workers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(include_angles)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;include_angles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(angle_threshold)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;angle_threshold
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(weight)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;weight
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_missing_branches
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_missing_branches">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(start_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(proximal_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;proximal_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(skeleton_coordinates)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_coordinates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_missing_branches_angle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_missing_branches_angle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(start_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(start_point_ids)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point_ids
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(proximal_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;proximal_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(vector_array)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;vector_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_coordinates)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_coordinates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(angle_threshold)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;angle_threshold
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(weight)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;weight
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_nearest_and_straightest_point_in_segmentation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_nearest_and_straightest_point_in_segmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(base_vector)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;base_vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(points_to_check)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;points_to_check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(angle_threshold)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;angle_threshold
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(weight)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;weight
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_nearest_point_in_segmentation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_nearest_point_in_segmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(points_to_check)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;points_to_check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prune_and_fix_skeleton
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prune_and_fix_skeleton">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(skeplex_skeleton)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeplex_skeleton
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(segmentation)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;segmentation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(branch_trimming_len)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;branch_trimming_len
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(break_distance)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;break_distance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.unit_vector_numba" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;unit_vector_numba
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" unit_vector_numba">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.unit_vector_numba(vector)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;vector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    constants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image_to_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    image_to_graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image_to_graph_lazy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    image_to_graph_lazy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modify_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    modify_graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sample
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skeleton_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skeleton_graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../measurements/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    measurements
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    measurements
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measurements/angles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    angles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measurements/branches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    branches
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measurements/fit_surface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fit_surface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measurements/graph_properties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    graph_properties
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measurements/lumen_classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    lumen_classifier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../measurements/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../skeleton/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    skeleton
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_5" id="__nav_2_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    skeleton
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_chunked_label/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _chunked_label
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_chunked_upscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _chunked_upscale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_segment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _segment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_skeletonize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _skeletonize
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_upscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _upscale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skeleton/distance_field/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    distance_field
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/_chunked/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _chunked
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/_geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _geometry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../visualize/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    visualize
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    visualize
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualize/_color/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    _color
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualize/spline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    spline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;check_background_intersection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" check_background_intersection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(end_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;end_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.check_background_intersection(step_size)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;step_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;filter_points_from_same_branch
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" filter_points_from_same_branch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch(query_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;query_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.filter_points_from_same_branch(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_breaks_in_skeleton
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_breaks_in_skeleton">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_obj)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_obj
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(end_point_radius)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;end_point_radius
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(segmentation_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;segmentation_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(n_workers)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;n_workers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(include_angles)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;include_angles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(angle_threshold)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;angle_threshold
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(weight)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;weight
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_missing_branches
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_missing_branches">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(start_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(proximal_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;proximal_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(skeleton_coordinates)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_coordinates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_missing_branches_angle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_missing_branches_angle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(start_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(start_point_ids)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point_ids
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(proximal_points)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;proximal_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(vector_array)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;vector_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_coordinates)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_coordinates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(angle_threshold)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;angle_threshold
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_missing_branches_angle(weight)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;weight
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_nearest_and_straightest_point_in_segmentation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_nearest_and_straightest_point_in_segmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(base_vector)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;base_vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(points_to_check)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;points_to_check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(angle_threshold)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;angle_threshold
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(weight)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;weight
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;find_nearest_point_in_segmentation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" find_nearest_point_in_segmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(start_point)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;start_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(points_to_check)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;points_to_check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;label_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(skeleton_label_image)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeleton_label_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prune_and_fix_skeleton
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prune_and_fix_skeleton">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(skeplex_skeleton)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;skeplex_skeleton
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(segmentation)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;segmentation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(branch_trimming_len)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;branch_trimming_len
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(break_distance)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;break_distance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.unit_vector_numba" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;unit_vector_numba
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" unit_vector_numba">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleplex.graph.break_detection.unit_vector_numba(vector)" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;vector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<div class="doc doc-object doc-module">



<h1 id="skeleplex.graph.break_detection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">skeleplex.graph.break_detection</span>


</h1>

    <div class="doc doc-contents first">

        <p>Functions for detecting and fixing breaks in skeletonized segmentations.</p>
<p>This module provides utilities to prune short branches and iteratively fix breaks in
skeletons, using KDTree-based proximity search and background intersection checks.</p>












<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            check_background_intersection (skeleplex.graph.break_detection.check_background_intersection)" href="#skeleplex.graph.break_detection.check_background_intersection">check_background_intersection</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check if a line segment intersects background in a label image.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            filter_points_from_same_branch (skeleplex.graph.break_detection.filter_points_from_same_branch)" href="#skeleplex.graph.break_detection.filter_points_from_same_branch">filter_points_from_same_branch</a></code></b>
            –
            <div class="doc-md-description">
              <p>Filter points that are on the same branch as the start point.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            find_breaks_in_skeleton (skeleplex.graph.break_detection.find_breaks_in_skeleton)" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton">find_breaks_in_skeleton</a></code></b>
            –
            <div class="doc-md-description">
              <p>Find breaks in a skeleton and suggest connections to fix them.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            find_missing_branches (skeleplex.graph.break_detection.find_missing_branches)" href="#skeleplex.graph.break_detection.find_missing_branches">find_missing_branches</a></code></b>
            –
            <div class="doc-md-description">
              <p>Find the nearest points in a segmentation for given start points.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            find_missing_branches_angle (skeleplex.graph.break_detection.find_missing_branches_angle)" href="#skeleplex.graph.break_detection.find_missing_branches_angle">find_missing_branches_angle</a></code></b>
            –
            <div class="doc-md-description">
              <p>Find the nearest and straightest points in a segmentation for given start points.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            find_nearest_and_straightest_point_in_segmentation (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation)" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation">find_nearest_and_straightest_point_in_segmentation</a></code></b>
            –
            <div class="doc-md-description">
              <p>Find the nearest and straightest point in a segmentation for a given start point.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            find_nearest_point_in_segmentation (skeleplex.graph.break_detection.find_nearest_point_in_segmentation)" href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation">find_nearest_point_in_segmentation</a></code></b>
            –
            <div class="doc-md-description">
              <p>Find the nearest point in a segmentation for a given start point.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            prune_and_fix_skeleton (skeleplex.graph.break_detection.prune_and_fix_skeleton)" href="#skeleplex.graph.break_detection.prune_and_fix_skeleton">prune_and_fix_skeleton</a></code></b>
            –
            <div class="doc-md-description">
              <p>Iteratively prunes short branches and fixes breaks in a skeleton until none remain.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            unit_vector_numba (skeleplex.graph.break_detection.unit_vector_numba)" href="#skeleplex.graph.break_detection.unit_vector_numba">unit_vector_numba</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute the unit vector of a given vector.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.check_background_intersection" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">check_background_intersection</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_background_intersection</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start_point (skeleplex.graph.break_detection.check_background_intersection(start_point))" href="#skeleplex.graph.break_detection.check_background_intersection(start_point)">start_point</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="end_point (skeleplex.graph.break_detection.check_background_intersection(end_point))" href="#skeleplex.graph.break_detection.check_background_intersection(end_point)">end_point</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="label_image (skeleplex.graph.break_detection.check_background_intersection(label_image))" href="#skeleplex.graph.break_detection.check_background_intersection(label_image)">label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.check_background_intersection(skeleton_label_image))" href="#skeleplex.graph.break_detection.check_background_intersection(skeleton_label_image)">skeleton_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="step_size (skeleplex.graph.break_detection.check_background_intersection(step_size))" href="#skeleplex.graph.break_detection.check_background_intersection(step_size)">step_size</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a line segment intersects background in a label image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.check_background_intersection(start_point)" class="doc doc-heading doc-heading-parameter">              <b><code>start_point</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array containing the starting point of the line segment.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.check_background_intersection(end_point)" class="doc doc-heading doc-heading-parameter">              <b><code>end_point</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array containing the end point of the line segment.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.check_background_intersection(label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The label image to check for background intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.check_background_intersection(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image to check for branch intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.check_background_intersection(step_size)" class="doc doc-heading doc-heading-parameter">              <b><code>step_size</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The distance between points to sample along the line segment.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>intersects_background</code></b> (              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
)          –
          <div class="doc-md-description">
            <p>True if the line segment intersects background, False otherwise.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>line_length</code></b> (              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
)          –
          <div class="doc-md-description">
            <p>The length of the line segment.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nogil</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_background_intersection</span><span class="p">(</span>
    <span class="n">start_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">end_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">skeleton_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">step_size</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a line segment intersects background in a label image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_point : np.ndarray</span>
<span class="sd">        (3,) array containing the starting point of the line segment.</span>
<span class="sd">    end_point : np.ndarray</span>
<span class="sd">        (3,) array containing the end point of the line segment.</span>
<span class="sd">    label_image : np.ndarray</span>
<span class="sd">        The label image to check for background intersection.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image to check for branch intersection.</span>
<span class="sd">    step_size : float</span>
<span class="sd">        The distance between points to sample along the line segment.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    intersects_background : bool</span>
<span class="sd">        True if the line segment intersects background, False otherwise.</span>
<span class="sd">    line_length : float</span>
<span class="sd">        The length of the line segment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">end_point</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">)</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">line_length</span> <span class="o">/</span> <span class="n">step_size</span><span class="p">)</span>

    <span class="c1"># unit vector in the direction to check</span>
    <span class="n">unit_vector</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_point</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">)</span> <span class="o">/</span> <span class="n">line_length</span>
    <span class="n">step_vector</span> <span class="o">=</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">unit_vector</span>

    <span class="c1"># get the branch label values for the start and end point</span>
    <span class="n">start_skeleton_value</span> <span class="o">=</span> <span class="n">skeleton_label_image</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">]</span>
    <span class="n">end_skeleton_value</span> <span class="o">=</span> <span class="n">skeleton_label_image</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">step_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_points</span><span class="p">):</span>
        <span class="n">query_point</span> <span class="o">=</span> <span class="n">start_point</span> <span class="o">+</span> <span class="n">step_index</span> <span class="o">*</span> <span class="n">step_vector</span>
        <span class="n">label_value</span> <span class="o">=</span> <span class="n">label_image</span><span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">query_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">query_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">query_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="n">skeleton_value</span> <span class="o">=</span> <span class="n">skeleton_label_image</span><span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">query_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">query_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">query_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">label_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># line intersects background</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">line_length</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">skeleton_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="n">skeleton_value</span> <span class="o">==</span> <span class="n">start_skeleton_value</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="n">skeleton_value</span> <span class="o">==</span> <span class="n">end_skeleton_value</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># line intersects a different branch</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">line_length</span>

    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">line_length</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.filter_points_from_same_branch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">filter_points_from_same_branch</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">filter_points_from_same_branch</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start_point (skeleplex.graph.break_detection.filter_points_from_same_branch(start_point))" href="#skeleplex.graph.break_detection.filter_points_from_same_branch(start_point)">start_point</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="query_points (skeleplex.graph.break_detection.filter_points_from_same_branch(query_points))" href="#skeleplex.graph.break_detection.filter_points_from_same_branch(query_points)">query_points</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.filter_points_from_same_branch(skeleton_label_image))" href="#skeleplex.graph.break_detection.filter_points_from_same_branch(skeleton_label_image)">skeleton_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Filter points that are on the same branch as the start point.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.filter_points_from_same_branch(start_point)" class="doc doc-heading doc-heading-parameter">              <b><code>start_point</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array of the coordinates of the start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.filter_points_from_same_branch(query_points)" class="doc doc-heading doc-heading-parameter">              <b><code>query_points</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(m, 3) array of the coordinates of the points to check.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.filter_points_from_same_branch(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image to check for branch intersection.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
          –
          <div class="doc-md-description">
            <p>(m,) boolean array where True indicates the point is on a different branch.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_points_from_same_branch</span><span class="p">(</span>
    <span class="n">start_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">query_points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">skeleton_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter points that are on the same branch as the start point.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_point : np.ndarray</span>
<span class="sd">        (3,) array of the coordinates of the start point.</span>
<span class="sd">    query_points : np.ndarray</span>
<span class="sd">        (m, 3) array of the coordinates of the points to check.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image to check for branch intersection.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        (m,) boolean array where True indicates the point is on a different branch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_point_label_value</span> <span class="o">=</span> <span class="n">skeleton_label_image</span><span class="p">[</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">]</span>

    <span class="c1"># loop through the query points</span>
    <span class="n">n_query_points</span> <span class="o">=</span> <span class="n">query_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">point_in_different_branch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_query_points</span><span class="p">,),</span> <span class="n">bool_</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">query_point_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_query_points</span><span class="p">):</span>
        <span class="n">query_label_value</span> <span class="o">=</span> <span class="n">skeleton_label_image</span><span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">query_points</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">query_points</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">query_points</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">query_label_value</span> <span class="o">==</span> <span class="n">start_point_label_value</span><span class="p">:</span>
            <span class="n">point_in_different_branch</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">point_in_different_branch</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">point_in_different_branch</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.find_breaks_in_skeleton" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">find_breaks_in_skeleton</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_breaks_in_skeleton</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="skeleton_obj (skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_obj))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_obj)">skeleton_obj</a></span><span class="p">:</span> <span class="n"><span title="skan.Skeleton">Skeleton</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="end_point_radius (skeleplex.graph.break_detection.find_breaks_in_skeleton(end_point_radius))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(end_point_radius)">end_point_radius</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="segmentation_label_image (skeleplex.graph.break_detection.find_breaks_in_skeleton(segmentation_label_image))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(segmentation_label_image)">segmentation_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_label_image))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_label_image)">skeleton_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="n_workers (skeleplex.graph.break_detection.find_breaks_in_skeleton(n_workers))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(n_workers)">n_workers</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="include_angles (skeleplex.graph.break_detection.find_breaks_in_skeleton(include_angles))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(include_angles)">include_angles</a></span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="angle_threshold (skeleplex.graph.break_detection.find_breaks_in_skeleton(angle_threshold))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(angle_threshold)">angle_threshold</a></span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="weight (skeleplex.graph.break_detection.find_breaks_in_skeleton(weight))" href="#skeleplex.graph.break_detection.find_breaks_in_skeleton(weight)">weight</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find breaks in a skeleton and suggest connections to fix them.</p>
<p>If angles are included, the function will consider the direction of existing
branches when suggesting connections,
preferring those that align with the branch direction.
The weighting between distance and angle is currently fixed at 50/50.
The points are only suggested if they do not intersect background or other branches.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_obj)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_obj</code></b>
</h3>              (<code><span title="skan.Skeleton">Skeleton</span></code>)
          –
          <div class="doc-md-description">
            <p>The skan skeleton object to find breaks in.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(end_point_radius)" class="doc doc-heading doc-heading-parameter">              <b><code>end_point_radius</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The radius around each end point to search for potential connections.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(segmentation_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>segmentation_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The segmentation label image used to check for background intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image used to check for branch intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(n_workers)" class="doc doc-heading doc-heading-parameter">              <b><code>n_workers</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>-1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of workers to use for parallel processing.
Default is -1 (use all available).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(include_angles)" class="doc doc-heading doc-heading-parameter">              <b><code>include_angles</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to include angle consideration when finding breaks. Default is True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(angle_threshold)" class="doc doc-heading doc-heading-parameter">              <b><code>angle_threshold</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>90</code>
)
          –
          <div class="doc-md-description">
            <p>The maximum angle (in degrees) allowed between the existing branch direction
and the direction to the potential connection point.
Only used if include_angles is True. Default is 90.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_breaks_in_skeleton(weight)" class="doc doc-heading doc-heading-parameter">              <b><code>weight</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>The weight given to distance in the combined score. Default is 0.5.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>node_ids</code></b> (              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
)          –
          <div class="doc-md-description">
            <p>The IDs of the nodes in the skeleton that are end points with detected breaks.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>source_coordinates</code></b> (              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
)          –
          <div class="doc-md-description">
            <p>The coordinates of the end points with detected breaks.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>destination_coordinates</code></b> (              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
)          –
          <div class="doc-md-description">
            <p>The coordinates of the suggested connection points to fix the breaks.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_breaks_in_skeleton</span><span class="p">(</span>
    <span class="n">skeleton_obj</span><span class="p">:</span> <span class="n">Skeleton</span><span class="p">,</span>
    <span class="n">end_point_radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">segmentation_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">skeleton_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">n_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">include_angles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">angle_threshold</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find breaks in a skeleton and suggest connections to fix them.</span>

<span class="sd">    If angles are included, the function will consider the direction of existing</span>
<span class="sd">    branches when suggesting connections,</span>
<span class="sd">    preferring those that align with the branch direction.</span>
<span class="sd">    The weighting between distance and angle is currently fixed at 50/50.</span>
<span class="sd">    The points are only suggested if they do not intersect background or other branches.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    skeleton_obj : Skeleton</span>
<span class="sd">        The skan skeleton object to find breaks in.</span>
<span class="sd">    end_point_radius : float</span>
<span class="sd">        The radius around each end point to search for potential connections.</span>
<span class="sd">    segmentation_label_image : np.ndarray</span>
<span class="sd">        The segmentation label image used to check for background intersection.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image used to check for branch intersection.</span>
<span class="sd">    n_workers : int</span>
<span class="sd">        The number of workers to use for parallel processing.</span>
<span class="sd">        Default is -1 (use all available).</span>
<span class="sd">    include_angles : bool</span>
<span class="sd">        Whether to include angle consideration when finding breaks. Default is True.</span>
<span class="sd">    angle_threshold : float</span>
<span class="sd">        The maximum angle (in degrees) allowed between the existing branch direction</span>
<span class="sd">        and the direction to the potential connection point.</span>
<span class="sd">        Only used if include_angles is True. Default is 90.</span>
<span class="sd">    weight : float</span>
<span class="sd">        The weight given to distance in the combined score. Default is 0.5.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    node_ids : np.ndarray</span>
<span class="sd">        The IDs of the nodes in the skeleton that are end points with detected breaks.</span>
<span class="sd">    source_coordinates : np.ndarray</span>
<span class="sd">        The coordinates of the end points with detected breaks.</span>
<span class="sd">    destination_coordinates : np.ndarray</span>
<span class="sd">        The coordinates of the suggested connection points to fix the breaks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># build the tree for finding points in radius</span>
    <span class="n">skeleton_coordinates</span> <span class="o">=</span> <span class="n">skeleton_obj</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">skeleton_tree</span> <span class="o">=</span> <span class="n">KDTree</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>

    <span class="c1"># get points proximal to end points</span>
    <span class="n">degree_1_nodes</span> <span class="o">=</span> <span class="n">_get_degree_1_nodes</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="p">)</span>

    <span class="n">proximal_points</span> <span class="o">=</span> <span class="n">skeleton_tree</span><span class="o">.</span><span class="n">query_ball_point</span><span class="p">(</span>
        <span class="n">degree_1_nodes</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">end_point_radius</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="n">n_workers</span>
    <span class="p">)</span>

    <span class="n">points_numba</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="k">for</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">proximal_points</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">include_angles</span><span class="p">:</span>
        <span class="n">degree_1_nodes_ids</span> <span class="o">=</span> <span class="n">_get_degree_1_nodes_ids</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="p">)</span>
        <span class="n">degree_1_vectors</span> <span class="o">=</span> <span class="n">_get_edge_vectors_degree1</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="p">)</span>
        <span class="n">edge_vectors</span><span class="p">,</span> <span class="n">row_indices</span> <span class="o">=</span> <span class="n">_vector_dict_to_array</span><span class="p">(</span>
            <span class="n">degree_1_nodes_ids</span><span class="p">,</span> <span class="n">degree_1_vectors</span>
        <span class="p">)</span>

        <span class="n">nearest_points</span> <span class="o">=</span> <span class="n">find_missing_branches_angle</span><span class="p">(</span>
            <span class="n">start_points</span><span class="o">=</span><span class="n">degree_1_nodes</span><span class="p">,</span>
            <span class="n">start_point_ids</span><span class="o">=</span><span class="n">row_indices</span><span class="p">,</span>
            <span class="n">proximal_points</span><span class="o">=</span><span class="n">points_numba</span><span class="p">,</span>
            <span class="n">vector_array</span><span class="o">=</span><span class="n">edge_vectors</span><span class="p">,</span>
            <span class="n">skeleton_coordinates</span><span class="o">=</span><span class="n">skeleton_coordinates</span><span class="p">,</span>
            <span class="n">label_image</span><span class="o">=</span><span class="n">segmentation_label_image</span><span class="p">,</span>
            <span class="n">skeleton_label_image</span><span class="o">=</span><span class="n">skeleton_label_image</span><span class="p">,</span>
            <span class="n">angle_threshold</span><span class="o">=</span><span class="n">angle_threshold</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nearest_points</span> <span class="o">=</span> <span class="n">find_missing_branches</span><span class="p">(</span>
            <span class="n">start_points</span><span class="o">=</span><span class="n">degree_1_nodes</span><span class="p">,</span>
            <span class="n">proximal_points</span><span class="o">=</span><span class="n">points_numba</span><span class="p">,</span>
            <span class="n">skeleton_coordinates</span><span class="o">=</span><span class="n">skeleton_coordinates</span><span class="p">,</span>
            <span class="n">label_image</span><span class="o">=</span><span class="n">segmentation_label_image</span><span class="p">,</span>
            <span class="n">skeleton_label_image</span><span class="o">=</span><span class="n">skeleton_label_image</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">to_join_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">nearest_points</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">source_coordinates</span> <span class="o">=</span> <span class="n">degree_1_nodes</span><span class="p">[</span><span class="n">to_join_mask</span><span class="p">]</span>
    <span class="n">destination_coordinates</span> <span class="o">=</span> <span class="n">nearest_points</span><span class="p">[</span><span class="n">to_join_mask</span><span class="p">]</span>

    <span class="c1"># get the ids of the nodes of the source_coordinates</span>
    <span class="n">degree_1_node_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="o">.</span><span class="n">degrees</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">node_ids</span> <span class="o">=</span> <span class="n">degree_1_node_ids</span><span class="p">[</span><span class="n">to_join_mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">node_ids</span><span class="p">,</span> <span class="n">source_coordinates</span><span class="p">,</span> <span class="n">destination_coordinates</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.find_missing_branches" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">find_missing_branches</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_missing_branches</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start_points (skeleplex.graph.break_detection.find_missing_branches(start_points))" href="#skeleplex.graph.break_detection.find_missing_branches(start_points)">start_points</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="proximal_points (skeleplex.graph.break_detection.find_missing_branches(proximal_points))" href="#skeleplex.graph.break_detection.find_missing_branches(proximal_points)">proximal_points</a></span><span class="p">:</span> <span class="n"><span title="numba.typed.List">List</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_coordinates (skeleplex.graph.break_detection.find_missing_branches(skeleton_coordinates))" href="#skeleplex.graph.break_detection.find_missing_branches(skeleton_coordinates)">skeleton_coordinates</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="label_image (skeleplex.graph.break_detection.find_missing_branches(label_image))" href="#skeleplex.graph.break_detection.find_missing_branches(label_image)">label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.find_missing_branches(skeleton_label_image))" href="#skeleplex.graph.break_detection.find_missing_branches(skeleton_label_image)">skeleton_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find the nearest points in a segmentation for given start points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches(start_points)" class="doc doc-heading doc-heading-parameter">              <b><code>start_points</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(n, 3) array of the coordinates of the start points.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches(proximal_points)" class="doc doc-heading doc-heading-parameter">              <b><code>proximal_points</code></b>
</h3>              (<code><span title="numba.typed.List">List</span>[<a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a>]</code>)
          –
          <div class="doc-md-description">
            <p>List of arrays containing the indices of points proximal to each start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches(skeleton_coordinates)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_coordinates</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(m, 3) array of the coordinates of the skeleton points.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches(label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The label image to check for background intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image to check for branch intersection.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
          –
          <div class="doc-md-description">
            <p>(n, 3) array of the coordinates of the nearest points.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_missing_branches</span><span class="p">(</span>
    <span class="n">start_points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">proximal_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">skeleton_coordinates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">skeleton_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the nearest points in a segmentation for given start points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_points : np.ndarray</span>
<span class="sd">        (n, 3) array of the coordinates of the start points.</span>
<span class="sd">    proximal_points : List[np.ndarray]</span>
<span class="sd">        List of arrays containing the indices of points proximal to each start point.</span>
<span class="sd">    skeleton_coordinates : np.ndarray</span>
<span class="sd">        (m, 3) array of the coordinates of the skeleton points.</span>
<span class="sd">    label_image : np.ndarray</span>
<span class="sd">        The label image to check for background intersection.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image to check for branch intersection.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        (n, 3) array of the coordinates of the nearest points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_proximal_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">proximal_points</span><span class="p">)</span>

    <span class="c1"># loop through the start points</span>
    <span class="n">all_nearest_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_proximal_points</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">point_index</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">n_proximal_points</span><span class="p">):</span>
        <span class="n">points_in_radius</span> <span class="o">=</span> <span class="n">skeleton_coordinates</span><span class="p">[</span><span class="n">proximal_points</span><span class="p">[</span><span class="n">point_index</span><span class="p">]]</span>

        <span class="c1"># get the start point</span>
        <span class="n">start_point</span> <span class="o">=</span> <span class="n">start_points</span><span class="p">[</span><span class="n">point_index</span><span class="p">]</span>

        <span class="n">nearest_point</span> <span class="o">=</span> <span class="n">find_nearest_point_in_segmentation</span><span class="p">(</span>
            <span class="n">start_point</span><span class="o">=</span><span class="n">start_point</span><span class="p">,</span>
            <span class="n">points_to_check</span><span class="o">=</span><span class="n">points_in_radius</span><span class="p">,</span>
            <span class="n">label_image</span><span class="o">=</span><span class="n">label_image</span><span class="p">,</span>
            <span class="n">skeleton_label_image</span><span class="o">=</span><span class="n">skeleton_label_image</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">all_nearest_points</span><span class="p">[</span><span class="n">point_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">nearest_point</span>

    <span class="k">return</span> <span class="n">all_nearest_points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.find_missing_branches_angle" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">find_missing_branches_angle</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_missing_branches_angle</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start_points (skeleplex.graph.break_detection.find_missing_branches_angle(start_points))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(start_points)">start_points</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="start_point_ids (skeleplex.graph.break_detection.find_missing_branches_angle(start_point_ids))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(start_point_ids)">start_point_ids</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="proximal_points (skeleplex.graph.break_detection.find_missing_branches_angle(proximal_points))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(proximal_points)">proximal_points</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="vector_array (skeleplex.graph.break_detection.find_missing_branches_angle(vector_array))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(vector_array)">vector_array</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_coordinates (skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_coordinates))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_coordinates)">skeleton_coordinates</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="label_image (skeleplex.graph.break_detection.find_missing_branches_angle(label_image))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(label_image)">label_image</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_label_image))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_label_image)">skeleton_label_image</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="angle_threshold (skeleplex.graph.break_detection.find_missing_branches_angle(angle_threshold))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(angle_threshold)">angle_threshold</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="weight (skeleplex.graph.break_detection.find_missing_branches_angle(weight))" href="#skeleplex.graph.break_detection.find_missing_branches_angle(weight)">weight</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find the nearest and straightest points in a segmentation for given start points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(start_points)" class="doc doc-heading doc-heading-parameter">              <b><code>start_points</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(n, 3) array of the coordinates of the start points.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(start_point_ids)" class="doc doc-heading doc-heading-parameter">              <b><code>start_point_ids</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(n,) array of the row indices of the start points in the vector_array.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(proximal_points)" class="doc doc-heading doc-heading-parameter">              <b><code>proximal_points</code></b>
</h3>              (<code><span title="numba.typed.List">List</span>[<a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a>]</code>)
          –
          <div class="doc-md-description">
            <p>List of arrays containing the indices of points proximal to each start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(vector_array)" class="doc doc-heading doc-heading-parameter">              <b><code>vector_array</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(m, 3) array of the direction vectors for each start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_coordinates)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_coordinates</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(p, 3) array of the coordinates of the skeleton points.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The label image to check for background intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image to check for branch intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(angle_threshold)" class="doc doc-heading doc-heading-parameter">              <b><code>angle_threshold</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The maximum angle (in degrees) allowed between the existing branch direction
and the direction to the potential connection point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_missing_branches_angle(weight)" class="doc doc-heading doc-heading-parameter">              <b><code>weight</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>The weight given to distance in the combined score. Default is 0.5.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
          –
          <div class="doc-md-description">
            <p>(n, 3) array of the coordinates of the nearest and straightest points.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_missing_branches_angle</span><span class="p">(</span>
    <span class="n">start_points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">start_point_ids</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>  <span class="c1"># now row indices (not raw IDs)</span>
    <span class="n">proximal_points</span><span class="p">,</span>
    <span class="n">vector_array</span><span class="p">,</span>
    <span class="n">skeleton_coordinates</span><span class="p">,</span>
    <span class="n">label_image</span><span class="p">,</span>
    <span class="n">skeleton_label_image</span><span class="p">,</span>
    <span class="n">angle_threshold</span><span class="p">,</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the nearest and straightest points in a segmentation for given start points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_points : np.ndarray</span>
<span class="sd">        (n, 3) array of the coordinates of the start points.</span>
<span class="sd">    start_point_ids : np.ndarray</span>
<span class="sd">        (n,) array of the row indices of the start points in the vector_array.</span>
<span class="sd">    proximal_points : List[np.ndarray]</span>
<span class="sd">        List of arrays containing the indices of points proximal to each start point.</span>
<span class="sd">    vector_array : np.ndarray</span>
<span class="sd">        (m, 3) array of the direction vectors for each start point.</span>
<span class="sd">    skeleton_coordinates : np.ndarray</span>
<span class="sd">        (p, 3) array of the coordinates of the skeleton points.</span>
<span class="sd">    label_image : np.ndarray</span>
<span class="sd">        The label image to check for background intersection.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image to check for branch intersection.</span>
<span class="sd">    angle_threshold : float</span>
<span class="sd">        The maximum angle (in degrees) allowed between the existing branch direction</span>
<span class="sd">        and the direction to the potential connection point.</span>
<span class="sd">    weight : float</span>
<span class="sd">        The weight given to distance in the combined score. Default is 0.5.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        (n, 3) array of the coordinates of the nearest and straightest points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_proximal_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">proximal_points</span><span class="p">)</span>
    <span class="n">all_nearest_and_straight_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_proximal_points</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">point_index</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">n_proximal_points</span><span class="p">):</span>
        <span class="n">points_in_radius</span> <span class="o">=</span> <span class="n">skeleton_coordinates</span><span class="p">[</span><span class="n">proximal_points</span><span class="p">[</span><span class="n">point_index</span><span class="p">]]</span>

        <span class="n">row_idx</span> <span class="o">=</span> <span class="n">start_point_ids</span><span class="p">[</span><span class="n">point_index</span><span class="p">]</span>
        <span class="n">base_vector</span> <span class="o">=</span> <span class="n">vector_array</span><span class="p">[</span><span class="n">row_idx</span><span class="p">]</span>
        <span class="n">start_point</span> <span class="o">=</span> <span class="n">start_points</span><span class="p">[</span><span class="n">point_index</span><span class="p">]</span>

        <span class="n">nearest_straight_point</span> <span class="o">=</span> <span class="n">find_nearest_and_straightest_point_in_segmentation</span><span class="p">(</span>
            <span class="n">start_point</span><span class="o">=</span><span class="n">start_point</span><span class="p">,</span>
            <span class="n">base_vector</span><span class="o">=</span><span class="n">base_vector</span><span class="p">,</span>
            <span class="n">points_to_check</span><span class="o">=</span><span class="n">points_in_radius</span><span class="p">,</span>
            <span class="n">label_image</span><span class="o">=</span><span class="n">label_image</span><span class="p">,</span>
            <span class="n">skeleton_label_image</span><span class="o">=</span><span class="n">skeleton_label_image</span><span class="p">,</span>
            <span class="n">angle_threshold</span><span class="o">=</span><span class="n">angle_threshold</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">all_nearest_and_straight_points</span><span class="p">[</span><span class="n">point_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">nearest_straight_point</span>

    <span class="k">return</span> <span class="n">all_nearest_and_straight_points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">find_nearest_and_straightest_point_in_segmentation</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_nearest_and_straightest_point_in_segmentation</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start_point (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(start_point))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(start_point)">start_point</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="base_vector (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(base_vector))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(base_vector)">base_vector</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="points_to_check (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(points_to_check))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(points_to_check)">points_to_check</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="label_image (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(label_image))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(label_image)">label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(skeleton_label_image))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(skeleton_label_image)">skeleton_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="angle_threshold (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(angle_threshold))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(angle_threshold)">angle_threshold</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="weight (skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(weight))" href="#skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(weight)">weight</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find the nearest and straightest point in a segmentation for a given start point.</p>
<p>The function finds points that do not intersect background or other branches,
and selects the one that minimizes a combined score of distance and angle to the
base vector.
The weighting between distance and angle is currently fixed at 50/50.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(start_point)" class="doc doc-heading doc-heading-parameter">              <b><code>start_point</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array of the coordinates of the start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(base_vector)" class="doc doc-heading doc-heading-parameter">              <b><code>base_vector</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array of the direction vector for the start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(points_to_check)" class="doc doc-heading doc-heading-parameter">              <b><code>points_to_check</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(m, 3) array of the coordinates of the points to check.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The label image to check for background intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image to check for branch intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(angle_threshold)" class="doc doc-heading doc-heading-parameter">              <b><code>angle_threshold</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>90</code>
)
          –
          <div class="doc-md-description">
            <p>The maximum angle (in degrees) allowed between the existing branch direction
and the direction to the potential connection point. Default is 90.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_and_straightest_point_in_segmentation(weight)" class="doc doc-heading doc-heading-parameter">              <b><code>weight</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.5</code>
)
          –
          <div class="doc-md-description">
            <p>The weight given to distance in the combined score. Default is 0.5.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
          –
          <div class="doc-md-description">
            <p>(3,) array of the coordinates of the nearest and straightest point.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_nearest_and_straightest_point_in_segmentation</span><span class="p">(</span>
    <span class="n">start_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">base_vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">points_to_check</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">skeleton_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">angle_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the nearest and straightest point in a segmentation for a given start point.</span>

<span class="sd">    The function finds points that do not intersect background or other branches,</span>
<span class="sd">    and selects the one that minimizes a combined score of distance and angle to the</span>
<span class="sd">    base vector.</span>
<span class="sd">    The weighting between distance and angle is currently fixed at 50/50.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_point : np.ndarray</span>
<span class="sd">        (3,) array of the coordinates of the start point.</span>
<span class="sd">    base_vector : np.ndarray</span>
<span class="sd">        (3,) array of the direction vector for the start point.</span>
<span class="sd">    points_to_check : np.ndarray</span>
<span class="sd">        (m, 3) array of the coordinates of the points to check.</span>
<span class="sd">    label_image : np.ndarray</span>
<span class="sd">        The label image to check for background intersection.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image to check for branch intersection.</span>
<span class="sd">    angle_threshold : float</span>
<span class="sd">        The maximum angle (in degrees) allowed between the existing branch direction</span>
<span class="sd">        and the direction to the potential connection point. Default is 90.</span>
<span class="sd">    weight : float</span>
<span class="sd">        The weight given to distance in the combined score. Default is 0.5.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        (3,) array of the coordinates of the nearest and straightest point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the points to query</span>
    <span class="n">points_to_query_mask</span> <span class="o">=</span> <span class="n">filter_points_from_same_branch</span><span class="p">(</span>
        <span class="n">start_point</span><span class="p">,</span>
        <span class="n">points_to_check</span><span class="p">,</span>
        <span class="n">skeleton_label_image</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">points_to_query</span> <span class="o">=</span> <span class="n">points_to_check</span><span class="p">[</span><span class="n">points_to_query_mask</span><span class="p">]</span>

    <span class="c1"># loop through array</span>
    <span class="n">n_query_points</span> <span class="o">=</span> <span class="n">points_to_query</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">all_intersects_background</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_query_points</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">bool_</span><span class="p">)</span>
    <span class="n">all_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_query_points</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">all_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_query_points</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">query_point_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_query_points</span><span class="p">):</span>
        <span class="n">query_point</span> <span class="o">=</span> <span class="n">points_to_query</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span>

        <span class="n">intersects_background</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">check_background_intersection</span><span class="p">(</span>
            <span class="n">start_point</span><span class="o">=</span><span class="n">start_point</span><span class="p">,</span>
            <span class="n">end_point</span><span class="o">=</span><span class="n">query_point</span><span class="p">,</span>
            <span class="n">label_image</span><span class="o">=</span><span class="n">label_image</span><span class="p">,</span>
            <span class="n">skeleton_label_image</span><span class="o">=</span><span class="n">skeleton_label_image</span><span class="p">,</span>
            <span class="n">step_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># compute angle</span>
        <span class="n">query_vector</span> <span class="o">=</span> <span class="n">unit_vector_numba</span><span class="p">(</span><span class="n">query_point</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">)</span>
        <span class="n">cos_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">base_vector</span><span class="p">,</span> <span class="n">query_vector</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cos_angle</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

        <span class="c1"># store the values</span>
        <span class="n">all_intersects_background</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">intersects_background</span>
        <span class="n">all_distances</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
        <span class="n">all_angles</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>

    <span class="c1"># find the shortest distance that doesn&#39;t intersect background</span>
    <span class="k">if</span> <span class="n">all_intersects_background</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># return nans if no point passes the filters</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="p">(</span><span class="n">all_distances</span> <span class="o">/</span> <span class="n">all_distances</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">all_angles</span> <span class="o">/</span> <span class="n">all_angles</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">best_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">all_intersects_background</span><span class="p">])</span>
        <span class="c1"># if best_index is using a large angle, return nan</span>
        <span class="k">if</span> <span class="n">all_angles</span><span class="p">[</span><span class="n">all_intersects_background</span><span class="p">][</span><span class="n">best_index</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">angle_threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">points_to_query</span><span class="p">[</span><span class="n">all_intersects_background</span><span class="p">][</span><span class="n">best_index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.find_nearest_point_in_segmentation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">find_nearest_point_in_segmentation</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_nearest_point_in_segmentation</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start_point (skeleplex.graph.break_detection.find_nearest_point_in_segmentation(start_point))" href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(start_point)">start_point</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="points_to_check (skeleplex.graph.break_detection.find_nearest_point_in_segmentation(points_to_check))" href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(points_to_check)">points_to_check</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="label_image (skeleplex.graph.break_detection.find_nearest_point_in_segmentation(label_image))" href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(label_image)">label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="skeleton_label_image (skeleplex.graph.break_detection.find_nearest_point_in_segmentation(skeleton_label_image))" href="#skeleplex.graph.break_detection.find_nearest_point_in_segmentation(skeleton_label_image)">skeleton_label_image</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find the nearest point in a segmentation for a given start point.</p>
<p>The function finds points that do not intersect background or other branches,
and selects the nearest one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_point_in_segmentation(start_point)" class="doc doc-heading doc-heading-parameter">              <b><code>start_point</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array of the coordinates of the start point.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_point_in_segmentation(points_to_check)" class="doc doc-heading doc-heading-parameter">              <b><code>points_to_check</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(m, 3) array of the coordinates of the points to check.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_point_in_segmentation(label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The label image to check for background intersection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.find_nearest_point_in_segmentation(skeleton_label_image)" class="doc doc-heading doc-heading-parameter">              <b><code>skeleton_label_image</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>The skeleton label image to check for branch intersection.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
          –
          <div class="doc-md-description">
            <p>(3,) array of the coordinates of the nearest point.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_nearest_point_in_segmentation</span><span class="p">(</span>
    <span class="n">start_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">points_to_check</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">skeleton_label_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the nearest point in a segmentation for a given start point.</span>

<span class="sd">    The function finds points that do not intersect background or other branches,</span>
<span class="sd">    and selects the nearest one.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_point : np.ndarray</span>
<span class="sd">        (3,) array of the coordinates of the start point.</span>
<span class="sd">    points_to_check : np.ndarray</span>
<span class="sd">        (m, 3) array of the coordinates of the points to check.</span>
<span class="sd">    label_image : np.ndarray</span>
<span class="sd">        The label image to check for background intersection.</span>
<span class="sd">    skeleton_label_image : np.ndarray</span>
<span class="sd">        The skeleton label image to check for branch intersection.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        (3,) array of the coordinates of the nearest point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the points to query</span>
    <span class="n">points_to_query_mask</span> <span class="o">=</span> <span class="n">filter_points_from_same_branch</span><span class="p">(</span>
        <span class="n">start_point</span><span class="p">,</span>
        <span class="n">points_to_check</span><span class="p">,</span>
        <span class="n">skeleton_label_image</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">points_to_query</span> <span class="o">=</span> <span class="n">points_to_check</span><span class="p">[</span><span class="n">points_to_query_mask</span><span class="p">]</span>

    <span class="c1"># loop through array</span>
    <span class="n">n_query_points</span> <span class="o">=</span> <span class="n">points_to_query</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">all_intersects_background</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_query_points</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">bool_</span><span class="p">)</span>
    <span class="n">all_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_query_points</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">query_point_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_query_points</span><span class="p">):</span>
        <span class="n">query_point</span> <span class="o">=</span> <span class="n">points_to_query</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span>

        <span class="n">intersects_background</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">check_background_intersection</span><span class="p">(</span>
            <span class="n">start_point</span><span class="o">=</span><span class="n">start_point</span><span class="p">,</span>
            <span class="n">end_point</span><span class="o">=</span><span class="n">query_point</span><span class="p">,</span>
            <span class="n">label_image</span><span class="o">=</span><span class="n">label_image</span><span class="p">,</span>
            <span class="n">skeleton_label_image</span><span class="o">=</span><span class="n">skeleton_label_image</span><span class="p">,</span>
            <span class="n">step_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># store the values</span>
        <span class="n">all_intersects_background</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">intersects_background</span>
        <span class="n">all_distances</span><span class="p">[</span><span class="n">query_point_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>

    <span class="c1"># find the shortest distance that doesn&#39;t intersect background</span>
    <span class="k">if</span> <span class="n">all_intersects_background</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># return nans if no point passes the filters</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shortest_distance_index</span> <span class="o">=</span> <span class="n">all_distances</span><span class="p">[</span><span class="n">all_intersects_background</span><span class="p">]</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">points_to_query</span><span class="p">[</span><span class="n">all_intersects_background</span><span class="p">][</span><span class="n">shortest_distance_index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.prune_and_fix_skeleton" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">prune_and_fix_skeleton</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prune_and_fix_skeleton</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="skeplex_skeleton (skeleplex.graph.break_detection.prune_and_fix_skeleton(skeplex_skeleton))" href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(skeplex_skeleton)">skeplex_skeleton</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="segmentation (skeleplex.graph.break_detection.prune_and_fix_skeleton(segmentation))" href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(segmentation)">segmentation</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="branch_trimming_len (skeleplex.graph.break_detection.prune_and_fix_skeleton(branch_trimming_len))" href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(branch_trimming_len)">branch_trimming_len</a></span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="break_distance (skeleplex.graph.break_detection.prune_and_fix_skeleton(break_distance))" href="#skeleplex.graph.break_detection.prune_and_fix_skeleton(break_distance)">break_distance</a></span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Iteratively prunes short branches and fixes breaks in a skeleton until none remain.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.prune_and_fix_skeleton(skeplex_skeleton)" class="doc doc-heading doc-heading-parameter">              <b><code>skeplex_skeleton</code></b>
</h3>              (<code><span title="ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Binary skeleton image.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.prune_and_fix_skeleton(segmentation)" class="doc doc-heading doc-heading-parameter">              <b><code>segmentation</code></b>
</h3>              (<code><span title="ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Segmentation image used for break detection.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.prune_and_fix_skeleton(branch_trimming_len)" class="doc doc-heading doc-heading-parameter">              <b><code>branch_trimming_len</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum length of branches to prune.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.prune_and_fix_skeleton(break_distance)" class="doc doc-heading doc-heading-parameter">              <b><code>break_distance</code></b>
</h3>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum distance for detecting breaks.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="skan.Skeleton">Skeleton</span></code>
          –
          <div class="doc-md-description">
            <p>The final pruned and fixed Skeleton object.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prune_and_fix_skeleton</span><span class="p">(</span>
    <span class="n">skeplex_skeleton</span><span class="p">,</span> <span class="n">segmentation</span><span class="p">,</span> <span class="n">branch_trimming_len</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">break_distance</span><span class="o">=</span><span class="mi">20</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iteratively prunes short branches and fixes breaks in a skeleton until none remain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    skeplex_skeleton : ndarray</span>
<span class="sd">        Binary skeleton image.</span>
<span class="sd">    segmentation : ndarray</span>
<span class="sd">        Segmentation image used for break detection.</span>
<span class="sd">    branch_trimming_len : float</span>
<span class="sd">        Maximum length of branches to prune.</span>
<span class="sd">    break_distance : float</span>
<span class="sd">        Maximum distance for detecting breaks.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Skeleton</span>
<span class="sd">        The final pruned and fixed Skeleton object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">skeleton_obj</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="p">(</span><span class="n">skeplex_skeleton</span><span class="p">)</span>
    <span class="n">total_pruned</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_breaks_fixed</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># --- Step 1: Prune short branches ---</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">summarize</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;num_deg1 pre prune&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">skeleton_obj</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="n">skeleton_obj</span><span class="o">.</span><span class="n">degrees</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]),</span>
        <span class="p">)</span>

        <span class="n">short_branches</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;branch-distance&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">branch_trimming_len</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;branch-type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">short_branch_indices</span> <span class="o">=</span> <span class="n">short_branches</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">short_branch_indices</span><span class="p">:</span>
            <span class="n">skeleton_obj</span> <span class="o">=</span> <span class="n">skeleton_obj</span><span class="o">.</span><span class="n">prune_paths</span><span class="p">(</span><span class="n">short_branch_indices</span><span class="p">)</span>
            <span class="n">total_pruned</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">short_branch_indices</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">short_branch_indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> branches pruned&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No short branches left to prune.&quot;</span><span class="p">)</span>
        <span class="c1"># --- Step 2: Detect and fix breaks ---</span>
        <span class="n">skeleton_label_fill</span> <span class="o">=</span> <span class="n">skeleton_obj</span><span class="o">.</span><span class="n">skeleton_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">skelplex_fill</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">skeleton_label_fill</span><span class="p">)</span>

        <span class="n">node_ids</span><span class="p">,</span> <span class="n">source_coords</span><span class="p">,</span> <span class="n">target_coords</span> <span class="o">=</span> <span class="n">find_breaks_in_skeleton</span><span class="p">(</span>
            <span class="n">skeleton_obj</span><span class="p">,</span> <span class="n">break_distance</span><span class="p">,</span> <span class="n">segmentation</span><span class="p">,</span> <span class="n">skelplex_fill</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> breaks in skeleton&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">source_coords</span><span class="p">,</span> <span class="n">target_coords</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">draw_line_segment</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">skelplex_fill</span><span class="p">)</span>
            <span class="n">total_breaks_fixed</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span>
            <span class="n">skeleton_obj</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="p">(</span><span class="n">skelplex_fill</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Update skeleton</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No breaks found.&quot;</span><span class="p">)</span>
        <span class="c1"># --- Exit condition ---</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">short_branch_indices</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pruning and break fixing complete. &quot;</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">skelplex_fill</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skeleplex.graph.break_detection.unit_vector_numba" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">unit_vector_numba</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">unit_vector_numba</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="vector (skeleplex.graph.break_detection.unit_vector_numba(vector))" href="#skeleplex.graph.break_detection.unit_vector_numba(vector)">vector</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the unit vector of a given vector.</p>
<p>Is numba compatible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h3 id="skeleplex.graph.break_detection.unit_vector_numba(vector)" class="doc doc-heading doc-heading-parameter">              <b><code>vector</code></b>
</h3>              (<code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>)
          –
          <div class="doc-md-description">
            <p>(3,) array of the vector to normalize.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
          –
          <div class="doc-md-description">
            <p>(3,) array of the unit vector.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>skeleplex/graph/break_detection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span><span class="p">(</span><span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">unit_vector_numba</span><span class="p">(</span><span class="n">vector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the unit vector of a given vector.</span>

<span class="sd">    Is numba compatible.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vector : np.ndarray</span>
<span class="sd">        (3,) array of the vector to normalize.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        (3,) array of the unit vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vector</span> <span class="o">*</span> <span class="n">vector</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vector</span>
    <span class="k">return</span> <span class="n">vector</span> <span class="o">/</span> <span class="n">norm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["search.highlight", "search.suggest", "content.code.copy", "content.code.annotate", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>